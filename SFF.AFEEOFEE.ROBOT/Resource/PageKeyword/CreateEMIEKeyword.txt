*** Settings ***
Library           Selenium2Library    15
Resource          ExcelKeyword.txt
Resource          ../MasterVariable.txt
Resource          PublicKeyword.txt

*** keyword ***
GoToHandsetManagement
    Wait Until Element Is Visible    xpath=//a[@rel='ddsubmenu5']
    Mouse Over    xpath=//a[@rel='ddsubmenu5']
    Wait Until Element Is Visible    xpath=//a[text()='Handset']    15s
    Mouse Over    xpath=//a[text()='Handset']
    Wait Until Element Is Visible    xpath=//a[text()='Handset Management']
    Click Element    xpath=//a[text()='Handset Management']
    Comment    Wait Until Element Is Visible    xpath=//td[text()='Handset']

CreateEMIE
    GoToHandsetManagement
    @{IMEINo}=    ReadExcel    ${ExcelSheetName_CreateEMIE}    ${CreateIMEI_IMEI}
    @{ProductName}=    ReadExcel    ${ExcelSheetName_CreateEMIE}    ${CreateIMEI_Product Name}
    ${ListIndex}    Get Length    ${IMEINo}
    : FOR    ${i}    IN RANGE    0    ${ListIndex}
    \    Wait Until Element Is Visible    xpath=//div[contains(@id,'j_id_id174pc3_body')]//input[contains(@id,'BtnNewUp')]    30s
    \    Click Element    xpath=//div[contains(@id,'j_id_id174pc3_body')]//input[contains(@id,'BtnNewUp')]
    \    Wait Until Element Is Visible    xpath=//input[contains(@id,'imeiTextAdd')]    30s
    \    Input Text    xpath=//input[contains(@id,'imeiTextAdd')]    ${IMEINo[${i}]}
    \    Wait Until Element Is Visible    xpath=//select[contains(@id,'brandTextAdd')]
    \    Click Element    xpath=//select[contains(@id,'brandTextAdd')]
    \    Wait Until Element Is Visible    xpath=(//select[contains(@id,'brandTextAdd')]//option[text()='Apple'])    30s
    \    Click Element    xpath=//select[contains(@id,'brandTextAdd')]//option[text()='Apple']    #Edit Brand
    \    WaitBeingProcess
    \    Wait Until Element Is Visible    xpath=//select[contains(@id,'modelTextAdd')]
    \    Click Element    xpath=//select[contains(@id,'modelTextAdd')]
    \    Wait Until Element Is Visible    xpath=(//select[contains(@id,'modelTextAdd')]//option[text()='IPHONE7P32'])    #Edit Model
    \    Click Element    xpath=(//select[contains(@id,'modelTextAdd')]//option[text()='IPHONE7P32'])    #Edit Model
    \    Wait Until Element Is Visible    xpath=//select[contains(@id,'statusCdTextAdd')]    30s
    \    Click Element    xpath=//select[contains(@id,'statusCdTextAdd')]
    \    Click Element    xpath=//select[contains(@id,'statusCdTextAdd')]//option[text()='Available']
    \    Wait Until Element Is Visible    xpath=//select[contains(@id,'handsetTypeTextAdd')]    30s
    \    Click Element    xpath=//select[contains(@id,'handsetTypeTextAdd')]
    \    Click Element    xpath=//select[contains(@id,'handsetTypeTextAdd')]//option[text()='Handset']
    \    Click Element    xpath=//input[contains(@id,'promotion')]
    \    WaitBeingProcess
    \    Wait Until Element Is Visible    xpath=//input[contains(@id,'ProductName')]    30s
    \    Comment    Input Text    xpath=//input[contains(@id,'ProductName')]    ${ProductName[${i}]}    #Database    #ใน IE มีปัญหา
    \    Execute Javascript    window.jQuery('#handSet\\\\:formActionPrimary\\\\:ProductName').val('${ProductName[${i}]}')    \    \    #ใช้สำหรับใน IE
    \    Click Element    xpath=//input[contains(@id,'BtnGo2')]    ##
    \    WaitBeingProcess
    \    Wait Until Element Is Visible    xpath=//table[contains(@id,'ProductTable')]    #table
    \    Wait Until Element Is Visible    xpath=//table[contains(@id,'ProductTable')]
    \    Click Element    xpath=//input[contains(@id,'selected')]
    \    WaitBeingProcess
    \    Click Element    xpath=//input[contains(@id,'BtnSaveAdd')]
    \    WaitBeingProcess
    \    ${ShowStatus}=    CheckAlertMsg    xpath=//form[contains(@id,'errorMessage')]//ul[@class='contentform']    ${ExcelSheetName_CreateEMIE}    ${CreateIMEI_Remark}    ${CreateIMEI_IMEI}
    \    ...    ${IMEINo[${i}]}
    \    ${DataSuccess}=    Run Keyword And Return Status    Wait Until Element Is Visible    xpath=//li[contains(.,'Data saved Successfully ')]
    \    ${column}=    Whatscolumn_DataNewRegister    ${ExcelSheetName_CreateEMIE}    ${CreateIMEI_Remark}
    \    ${row}=    Evaluate    ${i}+${2}
    \    Run Keyword If    ${ShowStatus}==False and \ ${DataSuccess}==False    Run Keywords    Click Element    xpath=//input[contains(@id,'BtnCancelAdd')]
    \    ...    AND    Continue For Loop
    \    CustomXlsxLibrary.Save Excel    ${PathFile}${ResultExcel}
